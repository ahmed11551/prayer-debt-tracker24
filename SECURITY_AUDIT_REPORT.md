# üîí –û—Ç—á–µ—Ç –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–¥–∞

**–î–∞—Ç–∞:** 2025-01-27  
**–ü—Ä–æ–µ–∫—Ç:** Prayer-Debt Tracker  
**–°—Ç–∞—Ç—É—Å:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### 1. ‚ö†Ô∏è –•–∞—Ä–¥–∫–æ–¥ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `src/lib/api.ts`  
**–°—Ç—Ä–æ–∫–∏:** 9, 19

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// –°—Ç—Ä–æ–∫–∞ 9 - –•–∞—Ä–¥–∫–æ–¥ Supabase Anon Key
const SUPABASE_ANON_KEY = import.meta.env.VITE_SUPABASE_ANON_KEY || "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...";

// –°—Ç—Ä–æ–∫–∞ 19 - –•–∞—Ä–¥–∫–æ–¥ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
return import.meta.env.VITE_API_TOKEN || "test_token_123";
```

**–†–∏—Å–∫:** 
- –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ø—É–±–ª–∏—á–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –õ—é–±–æ–π –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∫–ª—é—á–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ API
- –ù–∞—Ä—É—à–µ–Ω–∏–µ best practices –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:**
- ‚ùå –£–¥–∞–ª–∏—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –í—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤ `.gitignore` –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Å–µ–∫—Ä–µ—Ç—ã

---

### 2. ‚ö†Ô∏è CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å–ª–∏—à–∫–æ–º –æ—Ç–∫—Ä—ã—Ç–æ

**–§–∞–π–ª:** `supabase/functions/prayer-debt-api/index.ts`  
**–°—Ç—Ä–æ–∫–∞:** 8

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
const corsHeaders = {
  "Access-Control-Allow-Origin": "*",  // –†–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å –ª—é–±—ã—Ö –¥–æ–º–µ–Ω–æ–≤
  ...
};
```

**–†–∏—Å–∫:**
- –õ—é–±–æ–π —Å–∞–π—Ç –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–∞—à–µ–º—É API
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å CSRF –∞—Ç–∞–∫
- –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å `Access-Control-Allow-Origin` –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å whitelist —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- ‚úÖ –î–ª—è Telegram Mini App –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `https://web.telegram.org`

---

### 3. ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ user_id –≤ Edge Function

**–§–∞–π–ª:** `supabase/functions/prayer-debt-api/index.ts`  
**–°—Ç—Ä–æ–∫–∏:** 45-50, 106-108

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// –°—Ç—Ä–æ–∫–∞ 50 - user_id –±–µ—Ä–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Ç–æ–∫–µ–Ω–∞ –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
userId = token;

// –°—Ç—Ä–æ–∫–∞ 107 - –º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å user_id
userId = body.user_id || `user_${Date.now()}`;
```

**–†–∏—Å–∫:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ–ª–∞—Ç—å `user_id` –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —á—É–∂–∏–º –¥–∞–Ω–Ω—ã–º
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ Supabase Auth
- ‚úÖ –ò–∑–≤–ª–µ–∫–∞—Ç—å `user_id` –∏–∑ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏ Supabase

---

### 4. ‚ö†Ô∏è –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ localStorage

**–§–∞–π–ª—ã:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ (api.ts, DuaCard.tsx, audit-log.ts, –∏ –¥—Ä.)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage
- –ù–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –î–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ XSS –∞—Ç–∞–∫–∏

**–†–∏—Å–∫:**
- XSS –∞—Ç–∞–∫–∏ –º–æ–≥—É—Ç —É–∫—Ä–∞—Å—Ç—å –¥–∞–Ω–Ω—ã–µ
- localStorage –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º —Å–∫—Ä–∏–ø—Ç–∞–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram Cloud Storage –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ localStorage
- ‚úÖ –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å httpOnly cookies –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)

---

## ‚ö†Ô∏è –°–†–ï–î–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### 5. JSON.parse –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**–§–∞–π–ª—ã:** `src/lib/audit-log.ts:33, 69`, `src/components/dhikr/DuaCard.tsx:42, 132`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// audit-log.ts:33
const logs: AuditLogEntry[] = existing ? JSON.parse(existing) : [];

// DuaCard.tsx:42
const bookmarks = JSON.parse(existingBookmarks);
```

**–†–∏—Å–∫:**
- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ localStorage –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–ø–∞–¥–µ—Ç
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ graceful degradation

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –û–±–µ—Ä–Ω—É—Ç—å –≤—Å–µ `JSON.parse` –≤ try-catch
- ‚úÖ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å fallback –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

### 6. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `supabase/functions/prayer-debt-api/index.ts`  
**–°—Ç—Ä–æ–∫–∏:** 104, 245

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Zod –∏–ª–∏ –ø–æ–¥–æ–±–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–∏–ø—ã –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

## üêõ –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ë–ê–ì–ò

### 7. Race conditions –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

**–§–∞–π–ª:** `src/components/dhikr/DuaCard.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 177-193

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∞—É–¥–∏–æ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AbortController –¥–ª—è –æ—Ç–º–µ–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

### 8. Memory leaks –≤ audio player

**–§–∞–π–ª:** `src/components/dhikr/DuaCard.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 196-234

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Event listeners –º–æ–≥—É—Ç –Ω–µ –æ—á–∏—â–∞—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- Audio —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ event listeners —É–¥–∞–ª—è—é—Ç—Å—è –≤ cleanup
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ audio —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è

---

### 9. –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null/undefined

**–§–∞–π–ª—ã:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ú–Ω–æ–≥–æ –º–µ—Å—Ç, –≥–¥–µ –≤–æ–∑–º–æ–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ undefined —Å–≤–æ–π—Å—Ç–≤–∞–º
- –ù–µ—Ç optional chaining –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö

**–ü—Ä–∏–º–µ—Ä:**
```typescript
// –ú–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å, –µ—Å–ª–∏ userData.repayment_progress undefined
userData.repayment_progress.completed_prayers[prayerType]
```

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å optional chaining (`?.`)
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null/undefined
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å default values

---

## üìä –ü–†–û–ë–õ–ï–ú–´ –ö–ê–ß–ï–°–¢–í–ê –ö–û–î–ê

### 10. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ `any`

**–ù–∞–π–¥–µ–Ω–æ:** 13 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `any` —Ç–∏–ø–∞

**–§–∞–π–ª—ã:**
- `src/lib/api.ts` - 4 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `src/components/dhikr/DuaCard.tsx` - 3 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `src/components/dhikr/AdhkarCard.tsx` - 1 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- `supabase/functions/prayer-debt-api/index.ts` - 5 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ—Ç–µ—Ä—è type safety
- –°–ª–æ–∂–Ω–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –æ—à–∏–±–∫–∏ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- –ü–ª–æ—Ö–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IDE

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `any` –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `unknown` –µ—Å–ª–∏ —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω
- ‚úÖ –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö

---

### 11. console.log –≤ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–¥–µ

**–ù–∞–π–¥–µ–Ω–æ:** 43 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è console.log/warn/error

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –õ–æ–≥–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–±–æ—Ä–∫–µ
- –ú–æ–≥—É—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –ª–æ–≥–∏–∫—É
- –ó–∞–º–µ–¥–ª—è—é—Ç —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `winston`, `pino`)
- ‚úÖ –£–¥–∞–ª—è—Ç—å –ª–æ–≥–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–±–æ—Ä–∫–µ —á–µ—Ä–µ–∑ build tools
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å environment-based logging

---

### 12. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö

**–§–∞–π–ª—ã:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ async —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—à–∏–±–∫–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å try-catch –≤–æ –≤—Å–µ async —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):
1. ‚úÖ –£–¥–∞–ª–∏—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ –∫–ª—é—á–µ–π –∏–∑ `src/lib/api.ts`
2. ‚úÖ –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å CORS –≤ Edge Function
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é user_id –≤ Edge Function
4. ‚úÖ –û–±–µ—Ä–Ω—É—Ç—å –≤—Å–µ JSON.parse –≤ try-catch

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):
5. ‚úÖ –£–ª—É—á—à–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
6. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ memory leaks
7. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å `any` –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ):
8. ‚úÖ –£–±—Ä–∞—Ç—å console.log –∏–∑ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–¥–∞
9. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
10. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–∞ null/undefined

---

## üìù –ß–ï–ö–õ–ò–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

- [ ] –£–¥–∞–ª–∏—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ Supabase –∫–ª—é—á–∞
- [ ] –£–¥–∞–ª–∏—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ test_token_123
- [ ] –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å CORS –≤ Edge Function
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é user_id
- [ ] –û–±–µ—Ä–Ω—É—Ç—å JSON.parse –≤ try-catch (5 –º–µ—Å—Ç)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ Edge Function
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å race conditions –≤ audio loading
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å memory leaks –≤ audio player
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å `any` –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã (13 –º–µ—Å—Ç)
- [ ] –£–±—Ä–∞—Ç—å console.log –∏–∑ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–¥–∞ (43 –º–µ—Å—Ç–∞)
- [ ] –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

---

## üîó –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [TypeScript Best Practices](https://typescript-eslint.io/rules/)
- [React Security Best Practices](https://reactjs.org/docs/security.html)

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ 1.

