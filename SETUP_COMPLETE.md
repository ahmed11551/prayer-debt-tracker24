# ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ - –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

## üéâ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ (–ø—É–Ω–∫—Ç—ã 1-4)

### ‚úÖ 1. –ë—ç–∫–µ–Ω–¥ API –Ω–∞ Supabase

**–°—Ç–∞—Ç—É—Å:** –ì–û–¢–û–í–û ‚úÖ

- ‚úÖ –¢–∞–±–ª–∏—Ü—ã –≤ Supabase —Å–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã:
  - `prayer_debts` - –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
  - `progress_history` - –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  - `calculation_jobs` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã
  - `audit_log` - –ª–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π

- ‚úÖ Edge Function –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞:
  - –ù–∞–∑–≤–∞–Ω–∏–µ: `prayer-debt-api`
  - URL: `https://fvxkywczuqincnjilgzd.supabase.co/functions/v1/prayer-debt-api`
  - –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:
    - `POST /calculate` - —Ä–∞—Å—á–µ—Ç –¥–æ–ª–≥–∞
    - `GET /snapshot` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    - `PATCH /progress` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    - `GET /report.pdf` - PDF –æ—Ç—á–µ—Ç
    - `POST /calculations` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç
    - `GET /calculations/:jobId` - —Å—Ç–∞—Ç—É—Å —Ä–∞—Å—á–µ—Ç–∞

- ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (—É–∂–µ –±—ã–ª–∏ –≤ –ë–î)

### ‚úÖ 2. API –∫–ª–∏–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω

**–°—Ç–∞—Ç—É—Å:** –ì–û–¢–û–í–û ‚úÖ

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `src/lib/api.ts` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Supabase
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ localStorage
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram WebApp
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ user_id

### ‚úÖ 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** –ß–ê–°–¢–ò–ß–ù–û –ì–û–¢–û–í–û ‚ö†Ô∏è

- ‚úÖ –°–æ–∑–¥–∞–Ω `.env.example` —Å —à–∞–±–ª–æ–Ω–æ–º
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `ENV_SETUP.md` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω `SUPABASE_SETUP.md` —Å –¥–µ—Ç–∞–ª—è–º–∏
- ‚ö†Ô∏è **–ù–£–ñ–ù–û:** –°–æ–∑–¥–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π `.env` —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ
- ‚ö†Ô∏è **–ù–£–ñ–ù–û:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Vercel

### ‚ö†Ô∏è 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ e-Replika API

**–°—Ç–∞—Ç—É—Å:** –ù–£–ñ–ù–û –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–¢–¨ ‚ö†Ô∏è

- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –≤ –∫–æ–¥–µ
- ‚úÖ Fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è **–ù–£–ñ–ù–û:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã e-Replika API
- ‚ö†Ô∏è **–ù–£–ñ–ù–û:** –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á–∏ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É—é—Ç—Å—è)

---

## üìã –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å

### 1. –°–æ–∑–¥–∞—Ç—å `.env` —Ñ–∞–π–ª (–ª–æ–∫–∞–ª—å–Ω–æ)

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```bash
cp .env.example .env
```

–ó–∞—Ç–µ–º –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å).

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Vercel

1. –ó–∞–π–¥–∏—Ç–µ –≤ [Vercel Dashboard](https://vercel.com/dashboard)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. Settings ‚Üí Environment Variables
4. –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env.example`

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:**
- `VITE_SUPABASE_URL`
- `VITE_SUPABASE_ANON_KEY`

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–¥–ª—è e-Replika):**
- `VITE_API_BASE_URL`
- `VITE_E_REPLIKA_API_KEY`
- `VITE_API_TOKEN`

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å e-Replika API

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:
- `GET /api/terms` - —Å–ª–æ–≤–∞—Ä–∏–∫ —Ç–µ—Ä–º–∏–Ω–æ–≤
- `POST /api/calendar/convert-to-hijri` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Ö–∏–¥–∂—Ä—É
- `POST /api/calendar/convert-from-hijri` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ —Ö–∏–¥–∂—Ä—ã
- `POST /api/reports/pdf` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF

–ï—Å–ª–∏ API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback.

### 4. –î–µ–ø–ª–æ–π –Ω–∞ Vercel

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
powershell -ExecutionPolicy Bypass -File deploy.ps1

# –ò–ª–∏ —á–µ—Ä–µ–∑ Vercel CLI
npx vercel --prod
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
npm install
npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ó–∞–ø—Ä–æ—Å—ã –∫ Supabase Edge Functions
- –†–∞–±–æ—Ç—É fallback –Ω–∞ localStorage
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Telegram WebApp (–µ—Å–ª–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç–µ –≤ Telegram)

### –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ Supabase
3. –†–∞–±–æ—Ç–∞—é—Ç –ª–∏ –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|--------|--------|------------|
| –ë—ç–∫–µ–Ω–¥ API (Supabase) | ‚úÖ –ì–æ—Ç–æ–≤–æ | Edge Function –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞ |
| API –∫–ª–∏–µ–Ω—Ç | ‚úÖ –ì–æ—Ç–æ–≤–æ | –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è Supabase |
| RLS –ø–æ–ª–∏—Ç–∏–∫–∏ | ‚úÖ –ì–æ—Ç–æ–≤–æ | –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å .env –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Vercel |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ e-Replika | ‚ö†Ô∏è –ù—É–∂–Ω–æ | –ù—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å |
| –î–µ–ø–ª–æ–π | ‚ö†Ô∏è –ì–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é | –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è |

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–°–æ–∑–¥–∞—Ç—å `.env` —Ñ–∞–π–ª** (5 –º–∏–Ω—É—Ç)
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Vercel –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** (5 –º–∏–Ω—É—Ç)
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å e-Replika API** (10 –º–∏–Ω—É—Ç)
4. **–ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Vercel** (5 –º–∏–Ω—É—Ç)

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~25 –º–∏–Ω—É—Ç

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ Supabase (—á–µ—Ä–µ–∑ localStorage)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ e-Replika API (—á–µ—Ä–µ–∑ fallback)
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ—é—Ç graceful degradation
- –ú–æ–∂–Ω–æ –¥–µ–ø–ª–æ–∏—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!

---

**–î–∞—Ç–∞:** $(date)
**–í–µ—Ä—Å–∏—è:** 1.0.0

